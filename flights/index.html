<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Flights â€” PurpleFlights</title>
  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:0;background:#f7f7fb;color:#191a1f}
    .container{max-width:900px;margin:0 auto;padding:16px}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px;box-shadow:0 6px 12px rgba(0,0,0,.05)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    label{display:block;font-size:12px;color:#6b7280;margin-bottom:6px}
    input,select{width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff}
    .btn{display:inline-block;padding:10px 14px;border-radius:999px;border:1px solid #e5e7eb;text-decoration:none;color:#fff;background:#1f2937}
    h1{font-size:44px;margin:24px 0;text-align:center}
  </style>
</head>
<body>
  <main class="container">
    <h1>Flights</h1>
    <form id="search" class="card grid">
      <div><label>From</label><input id="from" placeholder="Bangkok (BKK)" /></div>
      <div><label>To</label><input id="to" placeholder="Tokyo (NRT)" /></div>
      <div><label>Depart</label><input id="date" type="date" /></div>
      <div><label>Return</label><input id="ret" type="date" /></div>
      <div><label>Cabin</label>
        <select id="cabin">
          <option value="ECONOMY">Economy</option>
          <option value="PREMIUM_ECONOMY">Premium Economy</option>
          <option value="BUSINESS">Business</option>
          <option value="FIRST">First</option>
        </select>
      </div>
      <div><label>Adults</label><input id="adults" type="number" min="1" max="9" value="1" /></div>
      <div style="align-self:end"><button class="btn" type="submit">Test selection</button></div>
    </form>
  </main>

  <!-- Keep this single module script at the very end so the form exists -->
  <!-- change the button in the form -->
<!-- find the button and make sure it looks exactly like this -->
<div style="align-self:end">
  <button id="go" class="btn" type="button">Test selection</button>
</div>

<!-- keep this single module script at the very end of the file -->
<script type="module">
  import { attachAutocomplete } from '/js/lib/autocomplete.js';

  const fromEl = document.getElementById('from');
  const toEl   = document.getElementById('to');
  attachAutocomplete(fromEl);
  attachAutocomplete(toEl);

  // safety: stop any native form submit
  document.getElementById('search').addEventListener('submit', (e)=> e.preventDefault());

  // open results in a NEW TAB on click
  document.getElementById('go').addEventListener('click', () => {
    const data = {
      from: fromEl.dataset.code || '',
      to: toEl.dataset.code || '',
      date: document.getElementById('date').value || '',
      ret: document.getElementById('ret').value || '',
      adults: document.getElementById('adults').value || '1',
      cabin: document.getElementById('cabin').value || 'ECONOMY',
    };
    if (!data.from || !data.to || !data.date) {
      alert('Fill From, To, and Depart.');
      return;
    }
    const url = '/flights/results.html?' + new URLSearchParams(data).toString();
    window.open(url, '_blank', 'noopener'); // opens new tab, keeps your page
  });
</script>

